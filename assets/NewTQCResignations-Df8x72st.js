import{j as e}from"./vendor-ui-3vVLwvSG.js";import{r as x}from"./vendor-react-3RSvEdhP.js";import{C as a,a as c,b as d,e as i,d as g,B as _,f as L}from"./index-DbE0N-7e.js";import{T as B,a as w,b as f,c as j,d as D,e as h}from"./table-C47-Z7GG.js";import{P as M}from"./LoadingSpinner-C546iy_4.js";import"./dialog-D5PoXStQ.js";import"./label-Dcyga6z7.js";import"./textarea-DKXFBtN7.js";import"./select-B9RdTlAY.js";import{a as F,L as y}from"./LazyCharts-DetV40kx.js";import{B as R}from"./vendor-charts-B2i3rig-.js";import{R as H}from"./NewTQCFilters-67u2fkdP.js";import{j as O,k as I,e as Q,l as Y,c as P,d as U}from"./newTqcStore-CYv8xO33.js";import"./switch-DEYTfbKs.js";import{D as G,m as J,ay as W}from"./vendor-icons-B-g4Br4W.js";import{f as k}from"./vendor-utils-CC1vNFCq.js";import"./vendor-i18n-BmxLmPQ7.js";const T={HEALTH_ISSUE:"건강 문제",FAMILY_MATTERS:"가정 사정",DISTANCE:"출퇴근 거리",LOW_SALARY:"급여 불만",JOB_CHANGE:"이직",ABSENCE:"무단 결근",ACCIDENT:"사고",OTHER:"기타"},z={HEALTH_ISSUE:"#EF4444",FAMILY_MATTERS:"#F97316",DISTANCE:"#EAB308",LOW_SALARY:"#22C55E",JOB_CHANGE:"#14B8A6",ABSENCE:"#3B82F6",ACCIDENT:"#8B5CF6",OTHER:"#6B7280"};function K({analysis:s,isLoading:n}){const l=x.useMemo(()=>s?s.byReason.reduce((o,u)=>o+u.count,0):0,[s]),t=x.useMemo(()=>s?s.byReason.map(o=>({grade:T[o.reason],count:o.count})):[],[s]),m=x.useMemo(()=>{const o={};return Object.entries(T).forEach(([u,N])=>{o[N]=z[u]}),o},[]);return n?e.jsxs(a,{children:[e.jsx(c,{children:e.jsx(d,{className:"text-lg",children:"퇴사 사유 분석"})}),e.jsx(i,{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"animate-pulse bg-muted rounded-full w-48 h-48"})})]}):e.jsxs(a,{children:[e.jsxs(c,{children:[e.jsx(d,{className:"text-lg",children:"퇴사 사유 분석"}),e.jsxs(g,{children:["총 ",l,"명 퇴사"]})]}),e.jsx(i,{children:t.length>0?e.jsx(F,{data:t,height:300,colors:m}):e.jsx("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:"퇴사 데이터가 없습니다."})})]})}function $({analysis:s,isLoading:n}){const l=x.useMemo(()=>s?s.byTeam.map(t=>({name:t.team,count:t.count})):[],[s]);return n?e.jsxs(a,{children:[e.jsx(c,{children:e.jsx(d,{className:"text-lg",children:"팀별 퇴사 현황"})}),e.jsx(i,{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"animate-pulse bg-muted rounded w-full h-48"})})]}):e.jsxs(a,{children:[e.jsxs(c,{children:[e.jsx(d,{className:"text-lg",children:"팀별 퇴사 현황"}),e.jsx(g,{children:"배치예정팀별 퇴사 인원"})]}),e.jsx(i,{children:l.length>0?e.jsx(y,{data:l,height:300,children:e.jsx(R,{dataKey:"count",fill:"#3B82F6",radius:[4,4,0,0]})}):e.jsx("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:"퇴사 데이터가 없습니다."})})]})}function q({analysis:s,isLoading:n}){const l=x.useMemo(()=>s?s.byMonth.map(t=>({name:t.month,count:t.count})):[],[s]);return n?e.jsxs(a,{children:[e.jsx(c,{children:e.jsx(d,{className:"text-lg",children:"월별 퇴사 추이"})}),e.jsx(i,{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"animate-pulse bg-muted rounded w-full h-48"})})]}):e.jsxs(a,{children:[e.jsxs(c,{children:[e.jsx(d,{className:"text-lg",children:"월별 퇴사 추이"}),e.jsx(g,{children:"최근 6개월 퇴사 현황"})]}),e.jsx(i,{children:l.length>0?e.jsx(y,{data:l,height:300,children:e.jsx(R,{dataKey:"count",fill:"#EF4444",radius:[4,4,0,0]})}):e.jsx("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:"퇴사 데이터가 없습니다."})})]})}function V({analysis:s}){const n=x.useMemo(()=>s?s.byReason.reduce((l,t)=>l+t.count,0):0,[s]);return s?e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(a,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"총 퇴사자 수"})}),e.jsx(i,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[n,"명"]})})]}),e.jsxs(a,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"평균 교육 기간"})}),e.jsx(i,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[s.averageTrainingDays,"일"]})})]}),e.jsxs(a,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"주요 퇴사 사유"})}),e.jsx(i,{children:e.jsx("div",{className:"text-2xl font-bold",children:s.byReason.length>0?T[s.byReason[0].reason]:"-"})})]})]}):null}const b={HEALTH_ISSUE:"건강 문제",FAMILY_MATTERS:"가정 사정",DISTANCE:"출퇴근 거리",LOW_SALARY:"급여 불만",JOB_CHANGE:"이직",ABSENCE:"무단 결근",ACCIDENT:"사고",OTHER:"기타"};function je(){const s=O(),n=I(),l=Q(),t=Y(),m=P(),{fetchResignations:o,fetchResignationAnalysis:u,fetchTeams:N,setResignationFilters:C}=U();x.useEffect(()=>{(async()=>await Promise.all([o(t),u(),N()]))()},[t]);const p=x.useMemo(()=>s.filter(r=>!(t.reasonCategory&&t.reasonCategory!=="all"&&r.reason_category!==t.reasonCategory||t.team&&t.team!=="all"&&r.trainee_id!==t.team||t.dateFrom&&r.resign_date<t.dateFrom||t.dateTo&&r.resign_date>t.dateTo)),[s,t]),E=r=>{C(r)},A=()=>{C({})};return m.analysis&&!n?e.jsx(M,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"퇴사 분석"}),e.jsx("p",{className:"text-muted-foreground",children:"신입 교육생 퇴사 현황 및 원인 분석"})]}),e.jsxs(_,{variant:"outline",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"리포트 다운로드"]})]}),e.jsx(V,{analysis:n}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsx(K,{analysis:n,isLoading:m.analysis}),e.jsx($,{analysis:n,isLoading:m.analysis}),e.jsx(q,{analysis:n,isLoading:m.analysis})]}),e.jsx(a,{children:e.jsx(i,{className:"pt-6",children:e.jsx(H,{filters:t,teams:l,onFiltersChange:E,onClear:A})})}),e.jsxs(a,{children:[e.jsx(c,{children:e.jsxs(d,{className:"text-lg flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"퇴사자 목록 (",p.length,")"]})}),e.jsx(i,{className:"p-0",children:e.jsxs(B,{children:[e.jsx(w,{children:e.jsxs(f,{children:[e.jsx(j,{children:"퇴사일"}),e.jsx(j,{children:"교육생 ID"}),e.jsx(j,{children:"퇴사 사유"}),e.jsx(j,{children:"상세 사유"}),e.jsx(j,{children:"교육 기간"})]})}),e.jsx(D,{children:m.resignations?e.jsx(f,{children:e.jsx(h,{colSpan:5,className:"text-center py-8",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),"로딩 중..."]})})}):p.length===0?e.jsx(f,{children:e.jsx(h,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"퇴사 기록이 없습니다."})}):p.map(r=>e.jsxs(f,{children:[e.jsx(h,{children:k(new Date(r.resign_date),"yyyy-MM-dd")}),e.jsx(h,{className:"font-medium",children:r.trainee_id}),e.jsx(h,{children:e.jsx(L,{variant:"secondary",children:b[r.reason_category]})}),e.jsx(h,{className:"text-muted-foreground max-w-[300px] truncate",children:r.reason_detail||"-"}),e.jsxs(h,{children:[r.training_duration_days,"일"]})]},r.resignation_id))})]})})]}),n&&e.jsxs(a,{children:[e.jsxs(c,{children:[e.jsxs(d,{className:"text-lg flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5"}),"분석 인사이트"]}),e.jsx(g,{children:"퇴사 데이터 기반 개선 포인트"})]}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-4",children:[n.byReason.length>0&&(()=>{const r=n.byReason.reduce((S,v)=>S+v.count,0);return e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"주요 퇴사 사유"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["가장 많은 퇴사 사유는 ",e.jsx("strong",{children:b[n.byReason[0].reason]}),"으로, 전체의 ",r>0?Math.round(n.byReason[0].count/r*100):0,"%를 차지합니다."]})]})})(),e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"평균 교육 기간"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["퇴사자들의 평균 교육 기간은 ",e.jsxs("strong",{children:[n.averageTrainingDays,"일"]}),"입니다.",n.averageTrainingDays<14&&e.jsx("span",{className:"text-destructive",children:" 초기 퇴사율이 높습니다. 입사 초기 적응 프로그램 강화를 권장합니다."})]})]}),n.byTeam.length>0&&e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"팀별 퇴사 현황"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:n.byTeam[0].team})," 팀의 퇴사율이 가장 높습니다 (",n.byTeam[0].count,"명). 해당 팀의 교육 환경 및 업무 강도를 점검해 보시기 바랍니다."]})]})]})})]})]})}export{je as default};

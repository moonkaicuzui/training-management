import{j as e}from"./vendor-ui-3vVLwvSG.js";import{u as M,k as B,r as i}from"./vendor-react-3RSvEdhP.js";import{B as u,C as _,e as y,D as Q,j as I,k as L,l as j,m as R}from"./index-DbE0N-7e.js";import{T as $,a as q,b as o,c as n,d as A,e as r}from"./table-C47-Z7GG.js";import{P as O}from"./LoadingSpinner-C546iy_4.js";import{T as W,C as H}from"./TraineeStatusBadge-27eUosfM.js";import"./dialog-D5PoXStQ.js";import"./label-Dcyga6z7.js";import"./textarea-DKXFBtN7.js";import"./select-B9RdTlAY.js";import"./LazyCharts-DetV40kx.js";import{T as U}from"./NewTQCFilters-67u2fkdP.js";import{a as z,e as G,f as F,c as J,d as K,N as V,T as X}from"./newTqcStore-CYv8xO33.js";import"./switch-DEYTfbKs.js";import{D as Y,P as Z,x as ee,E as se,a6 as ae,m as te}from"./vendor-icons-B-g4Br4W.js";import{f as re}from"./vendor-utils-CC1vNFCq.js";import"./vendor-i18n-BmxLmPQ7.js";import"./vendor-charts-B2i3rig-.js";function _e(){const d=M(),[m,f]=B(),p=z(),l=G(),a=F(),g=J(),{fetchTrainees:N,fetchTeams:b,setTraineeFilters:h,createTrainee:v}=K(),[k,c]=i.useState(!1),[D,T]=i.useState(null);i.useEffect(()=>{const s={},t=m.get("status"),C=m.get("team"),w=m.get("trainer");t&&(s.status=t),C&&(s.team=C),w&&(s.trainer=w),Object.keys(s).length>0&&h(s)},[]),i.useEffect(()=>{(async()=>await Promise.all([b(),N(a)]))()},[a]);const x=i.useMemo(()=>p.filter(s=>{if(a.status&&a.status!=="all"&&s.status!==a.status||a.team&&a.team!=="all"&&s.team_id!==a.team||a.trainer&&a.trainer!=="all"&&s.trainer_id!==a.trainer||a.startWeek&&s.start_week!==parseInt(a.startWeek))return!1;if(a.search){const t=a.search.toLowerCase();if(!s.name.toLowerCase().includes(t)&&!s.employee_id?.toLowerCase().includes(t))return!1}return!0}),[p,a]),P=s=>{h(s);const t=new URLSearchParams;s.status&&s.status!=="all"&&t.set("status",s.status),s.team&&s.team!=="all"&&t.set("team",s.team),s.trainer&&s.trainer!=="all"&&t.set("trainer",s.trainer),f(t)},S=()=>{h({}),f({})},E=async s=>{await v(s),c(!1),await N(a)};return g.teams&&l.length===0?e.jsx(O,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"교육생 목록"}),e.jsxs("p",{className:"text-muted-foreground",children:["신입 교육생 ",x.length,"명",a.status&&a.status!=="all"&&` (${a.status})`]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{variant:"outline",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"내보내기"]}),e.jsxs(u,{onClick:()=>c(!0),children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"교육생 등록"]})]})]}),e.jsx(_,{children:e.jsx(y,{className:"pt-6",children:e.jsx(U,{filters:a,teams:l,trainers:[...V],onFiltersChange:P,onClear:S})})}),e.jsx(_,{children:e.jsx(y,{className:"p-0",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(o,{children:[e.jsx(n,{children:"이름"}),e.jsx(n,{children:"사번"}),e.jsx(n,{children:"배치예정팀"}),e.jsx(n,{children:"트레이너"}),e.jsx(n,{children:"주차"}),e.jsx(n,{children:"시작일"}),e.jsx(n,{children:"상태"}),e.jsx(n,{children:"Color Blind"}),e.jsx(n,{children:"진행률"}),e.jsx(n,{className:"text-right",children:"작업"})]})}),e.jsx(A,{children:g.trainees?e.jsx(o,{children:e.jsx(r,{colSpan:10,className:"text-center py-8",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),"로딩 중..."]})})}):x.length===0?e.jsx(o,{children:e.jsx(r,{colSpan:10,className:"text-center py-8 text-muted-foreground",children:"등록된 교육생이 없습니다."})}):x.map(s=>e.jsxs(o,{className:"cursor-pointer hover:bg-accent",onClick:()=>d(`/new-tqc/trainees/${s.trainee_id}`),children:[e.jsx(r,{className:"font-medium",children:s.name}),e.jsx(r,{className:"text-muted-foreground",children:s.employee_id||"-"}),e.jsx(r,{children:l.find(t=>t.team_id===s.team_id)?.team_name||s.team_id}),e.jsx(r,{children:s.trainer_id}),e.jsxs(r,{children:[s.start_week,"주차"]}),e.jsx(r,{children:re(new Date(s.start_date),"yyyy-MM-dd")}),e.jsx(r,{children:e.jsx(W,{status:s.status})}),e.jsx(r,{children:e.jsx(H,{result:s.color_blind_status})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary transition-all",style:{width:`${s.progress_percentage}%`}})}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.progress_percentage,"%"]})]})}),e.jsx(r,{className:"text-right",children:e.jsxs(Q,{children:[e.jsx(I,{asChild:!0,onClick:t=>t.stopPropagation(),children:e.jsx(u,{variant:"ghost",size:"sm",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(L,{align:"end",children:[e.jsxs(j,{onClick:t=>{t.stopPropagation(),d(`/new-tqc/trainees/${s.trainee_id}`)},children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"상세보기"]}),e.jsxs(j,{onClick:t=>{t.stopPropagation(),T(s),c(!0)},children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"수정"]}),e.jsx(R,{}),s.status==="IN_TRAINING"&&e.jsxs(j,{className:"text-destructive",onClick:t=>{t.stopPropagation(),d(`/new-tqc/trainees/${s.trainee_id}/resign`)},children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"퇴사 처리"]})]})]})})]},s.trainee_id))})]})})}),e.jsx(X,{open:k,onClose:()=>{c(!1),T(null)},onSubmit:E,trainee:D,teams:l})]})}export{_e as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-charts-BNo0ya6L.js","assets/vendor-react-3RSvEdhP.js","assets/vendor-utils-DC3_vehr.js"])))=>i.map(i=>d[i]);
import{j as e}from"./vendor-ui-3vVLwvSG.js";import{r as y,u as K}from"./vendor-react-3RSvEdhP.js";import{_ as S,B as o,C as b,a as N,b as C,e as w,d as D,f as _}from"./index-CgMhWZQG.js";import{T as O,a as H,b as A,c as p,d as I,e as g}from"./table-C-QtM0IN.js";import{q as V,T as E,j as U,m as P,r as B,P as L,i as T,s as X,g as Y}from"./vendor-icons-O1RA8j5J.js";import{u as q}from"./normalizedStore-BVJQc_3I.js";import{P as J}from"./LoadingSpinner-8oabGzS7.js";import{u as Q}from"./vendor-i18n-BvwHJnYO.js";import{B as z}from"./vendor-charts-BNo0ya6L.js";import{f as M}from"./vendor-utils-DC3_vehr.js";function $({height:s=300}){return e.jsx("div",{className:"flex items-center justify-center bg-muted/30 rounded-lg animate-pulse",style:{height:s},children:e.jsx(V,{className:"h-8 w-8 animate-spin text-muted-foreground"})})}function W({data:s,height:r=300,children:n,xAxisKey:h="name",xAxisFormatter:u}){return e.jsx(y.Suspense,{fallback:e.jsx($,{height:r}),children:e.jsx(Z,{data:s,height:r,xAxisKey:h,xAxisFormatter:u,children:n})})}const Z=y.lazy(async()=>{const{BarChart:s,XAxis:r,YAxis:n,CartesianGrid:h,Tooltip:u,Legend:f,ResponsiveContainer:c}=await S(async()=>{const{BarChart:m,XAxis:t,YAxis:l,CartesianGrid:i,Tooltip:j,Legend:x,ResponsiveContainer:v}=await import("./vendor-charts-BNo0ya6L.js").then(k=>k.i);return{BarChart:m,XAxis:t,YAxis:l,CartesianGrid:i,Tooltip:j,Legend:x,ResponsiveContainer:v}},__vite__mapDeps([0,1,2]));return{default:function({data:t,height:l,children:i,xAxisKey:j,xAxisFormatter:x}){return e.jsx("div",{style:{height:l},children:e.jsx(c,{width:"100%",height:"100%",children:e.jsxs(s,{data:t,style:{cursor:"pointer"},children:[e.jsx(h,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(r,{dataKey:j,tickFormatter:x,className:"text-sm"}),e.jsx(n,{className:"text-sm"}),e.jsx(u,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(f,{}),i]})})})}}});function ee({data:s,height:r=300,colors:n={}}){return e.jsx(y.Suspense,{fallback:e.jsx($,{height:r}),children:e.jsx(se,{data:s,height:r,colors:n})})}const se=y.lazy(async()=>{const{PieChart:s,Pie:r,Cell:n,Tooltip:h,ResponsiveContainer:u}=await S(async()=>{const{PieChart:f,Pie:c,Cell:m,Tooltip:t,ResponsiveContainer:l}=await import("./vendor-charts-BNo0ya6L.js").then(i=>i.i);return{PieChart:f,Pie:c,Cell:m,Tooltip:t,ResponsiveContainer:l}},__vite__mapDeps([0,1,2]));return{default:function({data:c,height:m,colors:t={}}){return e.jsx("div",{style:{height:m},children:e.jsx(u,{width:"100%",height:"100%",children:e.jsxs(s,{children:[e.jsx(r,{data:c,cx:"50%",cy:"50%",labelLine:!1,label:({payload:l,percent:i})=>i&&i>0?`${l?.grade} (${Math.round(i*100)}%)`:"",outerRadius:100,fill:"#8884d8",dataKey:"count",nameKey:"grade",style:{cursor:"pointer"},children:c.map(l=>e.jsx(n,{fill:t[l.grade]||"#8884d8"},l.grade))}),e.jsx(h,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}})]})})})}}}),ae={AA:"#059669",A:"#10B981",B:"#F59E0B",C:"#EF4444"};function he(){const{t:s}=Q(),r=K(),{derived:n,loading:h,fetchDashboardStats:u,fetchMonthlyData:f,fetchGradeDistribution:c,fetchRetrainingTargets:m,fetchExpiringTrainings:t}=q(),l=n.dashboard.stats,i=n.dashboard.monthlyData,j=n.dashboard.gradeDistribution,x=n.retraining.targets,v=n.retraining.expiring,[k,R]=y.useState(null);if(y.useEffect(()=>{(async()=>{try{R(null),await Promise.all([u(),f(),c(),m(),t(30)])}catch(d){console.error("Dashboard data fetch error:",d),R(s("messages.loadError"))}})()},[]),h.views.dashboard)return e.jsx(J,{});if(k)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-4",children:[e.jsx(E,{className:"h-12 w-12 text-destructive"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:k}),e.jsx(o,{onClick:()=>window.location.reload(),children:s("common.retry")})]});const F=[{title:s("dashboard.totalEmployees"),value:l?.totalEmployees??0,icon:U,color:"text-primary",bgColor:"bg-primary/10",link:"/employees",trend:null},{title:s("dashboard.monthlyCompletions"),value:l?.monthlyCompletions??0,icon:P,color:"text-status-pass",bgColor:"bg-status-pass/10",link:"/results",trend:null},{title:s("dashboard.completionRate"),value:`${l?.overallCompletionRate??0}%`,icon:B,color:"text-primary",bgColor:"bg-primary/10",link:"/results",trend:null},{title:s("dashboard.retrainingNeeded"),value:l?.retrainingCount??0,icon:E,color:"text-destructive",bgColor:"bg-destructive/10",link:"/retraining",trend:null}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("dashboard.title")}),e.jsx("p",{className:"text-muted-foreground",children:s("dashboard.welcome")})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{onClick:()=>r("/schedule"),children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),s("dashboard.newTraining")]}),e.jsxs(o,{variant:"outline",onClick:()=>r("/results"),children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),s("dashboard.enterResults")]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:F.map((a,d)=>e.jsxs(b,{className:"cursor-pointer transition-all hover:shadow-lg hover:-translate-y-1 group",onClick:()=>r(a.link),role:"button",tabIndex:0,onKeyDown:G=>G.key==="Enter"&&r(a.link),children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(C,{className:"text-sm font-medium",children:a.title}),e.jsx("div",{className:`p-2 rounded-full ${a.bgColor} group-hover:scale-110 transition-transform`,children:e.jsx(a.icon,{className:`h-4 w-4 ${a.color}`})})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.value}),a.trend!==null&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{className:a.trend>0?"text-status-pass":"text-destructive",children:[a.trend>0?"↑":"↓"," ",Math.abs(a.trend),"%"]})," ",s("dashboard.fromLastMonth")]})]})]},d))}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(b,{children:[e.jsxs(N,{children:[e.jsx(C,{children:s("dashboard.monthlyChart")}),e.jsx(D,{children:s("dashboard.plannedVsCompleted")})]}),e.jsx(w,{children:i.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-center px-4",children:[e.jsx("div",{className:"rounded-full bg-muted p-6 mb-4",children:e.jsx(P,{className:"h-12 w-12 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:s("dashboard.noMonthlyData")}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-sm mb-4",children:s("dashboard.noMonthlyDataDesc")}),e.jsxs(o,{onClick:()=>r("/schedule"),variant:"outline",size:"sm",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),s("dashboard.scheduleTraining")]})]}):e.jsxs(W,{data:i,height:300,xAxisKey:"month",xAxisFormatter:a=>a.substring(5),children:[e.jsx(z,{dataKey:"planned",name:s("dashboard.planned"),fill:"#93C5FD",radius:[4,4,0,0]}),e.jsx(z,{dataKey:"completed",name:s("dashboard.completed"),fill:"#1E40AF",radius:[4,4,0,0]})]})})]}),e.jsxs(b,{children:[e.jsxs(N,{children:[e.jsx(C,{children:s("dashboard.gradeDistribution")}),e.jsx(D,{children:s("dashboard.gradeDesc")})]}),e.jsx(w,{children:j.length===0||j.every(a=>a.count===0)?e.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-center px-4",children:[e.jsx("div",{className:"rounded-full bg-muted p-6 mb-4",children:e.jsx(B,{className:"h-12 w-12 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:s("dashboard.noGradeData")}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-sm mb-4",children:s("dashboard.noGradeDataDesc")}),e.jsxs(o,{onClick:()=>r("/results"),variant:"outline",size:"sm",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),s("dashboard.enterResults")]})]}):e.jsx(ee,{data:j,height:300,colors:ae})})]})]}),e.jsxs(b,{children:[e.jsxs(N,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{children:s("retraining.title")}),e.jsxs(D,{children:[s("dashboard.retrainingList")," ",s("dashboard.recent10")]})]}),x.length>0&&e.jsx(o,{variant:"outline",size:"sm",onClick:()=>r("/retraining"),children:s("common.viewAll")})]}),e.jsx(w,{children:x.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center px-4",children:[e.jsx("div",{className:"rounded-full bg-status-pass/10 p-6 mb-4",children:e.jsx(T,{className:"h-12 w-12 text-status-pass"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:s("dashboard.noRetrainingNeeded")}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-sm",children:s("dashboard.allEmployeesCompliant")})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs(O,{children:[e.jsx(H,{children:e.jsxs(A,{children:[e.jsx(p,{children:s("employee.name")}),e.jsx(p,{children:s("employee.position")}),e.jsx(p,{children:s("employee.building")}),e.jsx(p,{children:s("common.program")}),e.jsx(p,{children:s("common.failDate")}),e.jsx(p,{children:s("common.score")}),e.jsx(p,{children:s("common.actions")})]})}),e.jsx(I,{children:x.slice(0,10).map((a,d)=>e.jsxs(A,{children:[e.jsx(g,{className:"font-medium",children:a.employee.employee_name}),e.jsx(g,{children:a.employee.position}),e.jsx(g,{children:s(`building.${a.employee.building}`)}),e.jsxs(g,{children:[e.jsx(_,{variant:"outline",children:a.program.program_code}),e.jsx("span",{className:"ml-2 text-sm",children:a.program.program_name})]}),e.jsx(g,{children:M(new Date(a.last_result.training_date),"yyyy-MM-dd")}),e.jsx(g,{children:e.jsx(_,{variant:"destructive",children:a.last_result.score??"N/A"})}),e.jsx(g,{children:e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>r(`/employees/${a.employee.employee_id}`),children:s("common.detail")})})]},d))})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:x.slice(0,10).map((a,d)=>e.jsxs(b,{className:"p-4 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-base",children:a.employee.employee_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.employee.position})]}),e.jsx(_,{variant:"destructive",children:a.last_result.score??"N/A"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("employee.building"),":"]}),e.jsx("span",{className:"font-medium",children:s(`building.${a.employee.building}`)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("common.program"),":"]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(_,{variant:"outline",className:"mb-1",children:a.program.program_code}),e.jsx("span",{className:"text-xs",children:a.program.program_name})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("common.failDate"),":"]}),e.jsx("span",{className:"font-medium",children:M(new Date(a.last_result.training_date),"yyyy-MM-dd")})]})]}),e.jsx(o,{variant:"outline",size:"sm",className:"w-full mt-3",onClick:()=>r(`/employees/${a.employee.employee_id}`),children:s("common.detail")})]},d))})]})})]}),v.length>0&&e.jsxs(b,{className:"border-warning/50 bg-warning/5",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-full bg-warning/20",children:e.jsx(X,{className:"h-5 w-5 text-warning"})}),e.jsxs("div",{children:[e.jsx(C,{className:"text-lg",children:s("progress.expiring")}),e.jsxs(D,{children:[s("dashboard.recent10")," - ",v.length,"건"]})]})]}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>r("/retraining"),children:s("common.viewAll")})]}),e.jsx(w,{children:e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:v.slice(0,6).map((a,d)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-background hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>r(`/employees/${a.employee.employee_id}`),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:a.employee.employee_name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:a.program.program_name})]}),e.jsx("div",{className:"flex items-center gap-2 ml-2",children:e.jsxs(_,{variant:a.days_until_expiry<=7?"destructive":"outline",className:a.days_until_expiry<=7?"":"border-warning text-warning",children:[e.jsx(Y,{className:"h-3 w-3 mr-1"}),"D-",a.days_until_expiry]})})]},d))})})]})]})}export{he as default};

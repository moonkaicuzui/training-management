import{j as e}from"./vendor-ui-3vVLwvSG.js";import{u as K,k as Y,r as d}from"./vendor-react-3RSvEdhP.js";import{C as l,a as P,b as k,d as M,e as r,f as C,B as m,I as Z}from"./index-DbE0N-7e.js";import{T as A,a as L,b as g,c as t,d as B,e as n}from"./table-C47-Z7GG.js";import{S as R,a as z,b as D,c as Q,d as o}from"./select-B9RdTlAY.js";import{C as I}from"./checkbox-Dpm-Lu5v.js";import{u as ee}from"./vendor-i18n-BmxLmPQ7.js";import{w as U,j as O,h as V,J as se,t as X,V as ae,s as te,S as ne,W as le}from"./vendor-icons-B-g4Br4W.js";import{f as E}from"./vendor-utils-CC1vNFCq.js";import"./vendor-charts-B2i3rig-.js";const v=[{session_id:"SES-001",program_code:"QIP-001",program_name:"QIP 기초 교육",session_date:E(new Date,"yyyy-MM-dd"),session_time:"09:00",trainer_name:"김강사",location:"A동 2층 교육실",attendees:[{employee_id:"EMP-001",employee_name:"홍길동",department:"QIP",position:"TQC"},{employee_id:"EMP-002",employee_name:"김철수",department:"QIP",position:"RQC"},{employee_id:"EMP-003",employee_name:"이영희",department:"Production",position:"Line Leader"}]},{session_id:"SES-002",program_code:"PRO-001",program_name:"생산 품질 관리",session_date:E(new Date,"yyyy-MM-dd"),session_time:"14:00",trainer_name:"박강사",location:"B동 1층 대강당",attendees:[{employee_id:"EMP-004",employee_name:"박지성",department:"Production",position:"Operator"},{employee_id:"EMP-005",employee_name:"손흥민",department:"Production",position:"Line Leader"}]}];function pe(){ee();const f=K(),[H]=Y(),_=H.get("session"),[u,$]=d.useState(""),[c,S]=d.useState({}),[h,p]=d.useState(new Set),[T,J]=d.useState("PRESENT"),i=d.useMemo(()=>{if(!_)return null;const s=v.find(a=>a.session_id===_);if(s&&Object.keys(c).length===0){const a={};s.attendees.forEach(x=>{a[x.employee_id]="PRESENT"}),S(a)}return s},[_,c]),y=d.useMemo(()=>{const s=E(new Date,"yyyy-MM-dd");return v.filter(a=>a.session_date===s)},[]),N=d.useMemo(()=>i?i.attendees.filter(s=>s.employee_name.toLowerCase().includes(u.toLowerCase())||s.employee_id.toLowerCase().includes(u.toLowerCase())):[],[i,u]),j=d.useMemo(()=>{const s={present:0,absent:0,late:0,excused:0,total:0};return Object.values(c).forEach(a=>{s[a.toLowerCase()]++,s.total++}),s},[c]),b=(s,a)=>{S(x=>({...x,[s]:a}))},W=s=>{p(s?new Set(N.map(a=>a.employee_id)):new Set)},q=(s,a)=>{p(x=>{const w=new Set(x);return a?w.add(s):w.delete(s),w})},F=()=>{S(s=>{const a={...s};return h.forEach(x=>{a[x]=T}),a}),p(new Set)},G=async()=>{console.log("Saving attendance:",{session_id:i?.session_id,attendance:c}),alert("출석이 저장되었습니다.")};return i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>f("/attendance"),children:e.jsx(se,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"출석 체크"}),e.jsxs("p",{className:"text-muted-foreground",children:[i.program_name," - ",i.session_date," ",i.session_time]})]})]}),e.jsxs(m,{onClick:G,children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"출석 저장"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-5",children:[e.jsx(l,{children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx(O,{className:"h-6 w-6 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-2xl font-bold",children:j.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"전체"})]})}),e.jsx(l,{className:"border-green-200 bg-green-50",children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx(V,{className:"h-6 w-6 mx-auto mb-2 text-green-600"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:j.present}),e.jsx("p",{className:"text-xs text-green-600",children:"출석"})]})}),e.jsx(l,{className:"border-red-200 bg-red-50",children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx(ae,{className:"h-6 w-6 mx-auto mb-2 text-red-600"}),e.jsx("p",{className:"text-2xl font-bold text-red-700",children:j.absent}),e.jsx("p",{className:"text-xs text-red-600",children:"결석"})]})}),e.jsx(l,{className:"border-yellow-200 bg-yellow-50",children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx(U,{className:"h-6 w-6 mx-auto mb-2 text-yellow-600"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:j.late}),e.jsx("p",{className:"text-xs text-yellow-600",children:"지각"})]})}),e.jsx(l,{className:"border-blue-200 bg-blue-50",children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx(te,{className:"h-6 w-6 mx-auto mb-2 text-blue-600"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:j.excused}),e.jsx("p",{className:"text-xs text-blue-600",children:"사유결석"})]})})]}),e.jsx(l,{children:e.jsx(r,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(ne,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(Z,{placeholder:"이름 또는 사번 검색...",className:"pl-8",value:u,onChange:s=>$(s.target.value)})]}),h.size>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h.size,"명 선택됨"]}),e.jsxs(R,{value:T,onValueChange:s=>J(s),children:[e.jsx(z,{className:"w-32",children:e.jsx(D,{})}),e.jsxs(Q,{children:[e.jsx(o,{value:"PRESENT",children:"출석"}),e.jsx(o,{value:"ABSENT",children:"결석"}),e.jsx(o,{value:"LATE",children:"지각"}),e.jsx(o,{value:"EXCUSED",children:"사유결석"})]})]}),e.jsx(m,{size:"sm",onClick:F,children:"일괄 적용"})]})]})})}),e.jsx(l,{children:e.jsx(r,{className:"p-0",children:e.jsxs(A,{children:[e.jsx(L,{children:e.jsxs(g,{children:[e.jsx(t,{className:"w-12",children:e.jsx(I,{checked:h.size===N.length&&N.length>0,onCheckedChange:W})}),e.jsx(t,{children:"사번"}),e.jsx(t,{children:"이름"}),e.jsx(t,{children:"부서"}),e.jsx(t,{children:"직책"}),e.jsx(t,{children:"출석 상태"}),e.jsx(t,{children:"빠른 체크"})]})}),e.jsx(B,{children:N.map(s=>e.jsxs(g,{children:[e.jsx(n,{children:e.jsx(I,{checked:h.has(s.employee_id),onCheckedChange:a=>q(s.employee_id,a)})}),e.jsx(n,{className:"font-mono",children:s.employee_id}),e.jsx(n,{className:"font-medium",children:s.employee_name}),e.jsx(n,{children:s.department}),e.jsx(n,{children:s.position}),e.jsx(n,{children:e.jsxs(R,{value:c[s.employee_id]||"PRESENT",onValueChange:a=>b(s.employee_id,a),children:[e.jsx(z,{className:"w-32",children:e.jsx(D,{})}),e.jsxs(Q,{children:[e.jsx(o,{value:"PRESENT",children:"출석"}),e.jsx(o,{value:"ABSENT",children:"결석"}),e.jsx(o,{value:"LATE",children:"지각"}),e.jsx(o,{value:"EXCUSED",children:"사유결석"})]})]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(m,{size:"icon",variant:c[s.employee_id]==="PRESENT"?"default":"outline",className:"h-8 w-8",onClick:()=>b(s.employee_id,"PRESENT"),children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx(m,{size:"icon",variant:c[s.employee_id]==="ABSENT"?"destructive":"outline",className:"h-8 w-8",onClick:()=>b(s.employee_id,"ABSENT"),children:e.jsx(le,{className:"h-4 w-4"})})]})})]},s.employee_id))})]})})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"출석 체크"}),e.jsx("p",{className:"text-muted-foreground",children:"교육 세션별 출석을 관리합니다"})]}),y.length>0&&e.jsxs(l,{className:"border-primary/50 bg-primary/5",children:[e.jsxs(P,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-primary"}),"오늘 예정된 교육"]}),e.jsxs(M,{children:[y.length,"개의 세션이 오늘 예정되어 있습니다"]})]}),e.jsx(r,{children:e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:y.map(s=>e.jsx(l,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>f(`/attendance?session=${s.session_id}`),children:e.jsxs(r,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx(C,{variant:"outline",children:s.program_code}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.session_time})]}),e.jsx("p",{className:"font-medium truncate",children:s.program_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.attendees.length,"명 예정"]})]})]})},s.session_id))})})]}),e.jsxs(l,{children:[e.jsxs(P,{children:[e.jsx(k,{children:"예정된 교육 세션"}),e.jsx(M,{children:"출석을 체크할 세션을 선택하세요"})]}),e.jsx(r,{children:e.jsxs(A,{children:[e.jsx(L,{children:e.jsxs(g,{children:[e.jsx(t,{children:"날짜"}),e.jsx(t,{children:"시간"}),e.jsx(t,{children:"프로그램"}),e.jsx(t,{children:"강사"}),e.jsx(t,{children:"장소"}),e.jsx(t,{children:"예정 인원"}),e.jsx(t,{children:"액션"})]})}),e.jsx(B,{children:v.map(s=>e.jsxs(g,{children:[e.jsx(n,{children:s.session_date}),e.jsx(n,{children:s.session_time}),e.jsx(n,{children:e.jsxs("div",{children:[e.jsx(C,{variant:"outline",className:"mr-2",children:s.program_code}),s.program_name]})}),e.jsx(n,{children:s.trainer_name}),e.jsx(n,{children:s.location}),e.jsx(n,{children:e.jsxs(C,{variant:"secondary",children:[s.attendees.length,"명"]})}),e.jsx(n,{children:e.jsxs(m,{size:"sm",onClick:()=>f(`/attendance?session=${s.session_id}`),children:[e.jsx(V,{className:"h-4 w-4 mr-1"}),"출석 체크"]})})]},s.session_id))})]})})]})]})}export{pe as default};

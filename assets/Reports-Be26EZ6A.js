import{j as e}from"./vendor-ui-3vVLwvSG.js";import{r as m}from"./vendor-react-3RSvEdhP.js";import{u as v,w as G}from"./xlsx-C2K9OxTh.js";import{C as i,e as r,B as E,a as C,b as f,d as y,f as u}from"./index-CgMhWZQG.js";import{T as I,a as Q,b as g,c as t,d as M,e as l}from"./table-C-QtM0IN.js";import{S as k,a as V,b as D,c as A,d}from"./select-BFo01T9H.js";import{T as W,a as q,b,c as T}from"./tabs-CxOMK5TM.js";import{u as z}from"./vendor-i18n-BvwHJnYO.js";import{g as J,j as L,m as B,r as K,k as X,O as Y,D as O,Q as Z,V as ee}from"./vendor-icons-O1RA8j5J.js";import{f as _}from"./vendor-utils-DC3_vehr.js";import"./vendor-charts-BNo0ya6L.js";const se=[{value:"QIP",label:"QIP"},{value:"Production",label:"Production"},{value:"Quality",label:"Quality"}],ae=[{department:"QIP",totalEmployees:25,completedTrainings:120,pendingTrainings:15,completionRate:89,averageScore:87,passRate:92},{department:"Production",totalEmployees:150,completedTrainings:580,pendingTrainings:45,completionRate:93,averageScore:82,passRate:88},{department:"Quality",totalEmployees:35,completedTrainings:175,pendingTrainings:10,completionRate:95,averageScore:90,passRate:95}],w=[{program_code:"QIP-001",program_name:"QIP 기초 교육",totalSessions:12,totalTrainees:156,passCount:142,failCount:14,passRate:91,averageScore:85,retrainingCount:14},{program_code:"QIP-002",program_name:"QIP 심화 교육",totalSessions:8,totalTrainees:98,passCount:88,failCount:10,passRate:90,averageScore:83,retrainingCount:10},{program_code:"PRO-001",program_name:"생산 품질 관리",totalSessions:20,totalTrainees:320,passCount:285,failCount:35,passRate:89,averageScore:81,retrainingCount:35},{program_code:"PRO-002",program_name:"안전 교육",totalSessions:15,totalTrainees:245,passCount:230,failCount:15,passRate:94,averageScore:88,retrainingCount:15}],N=[{employee_id:"EMP-001",employee_name:"홍길동",department:"QIP",position:"TQC",building:"A",line:"L1",hire_date:"2022-03-15",status:"ACTIVE",passCount:8,totalCount:8},{employee_id:"EMP-002",employee_name:"김철수",department:"QIP",position:"RQC",building:"A",line:"L2",hire_date:"2021-06-20",status:"ACTIVE",passCount:12,totalCount:13},{employee_id:"EMP-003",employee_name:"이영희",department:"Production",position:"Line Leader",building:"B",line:"L1",hire_date:"2020-01-10",status:"ACTIVE",passCount:15,totalCount:15},{employee_id:"EMP-004",employee_name:"박지성",department:"Production",position:"Operator",building:"B",line:"L2",hire_date:"2023-02-01",status:"ACTIVE",passCount:5,totalCount:6},{employee_id:"EMP-005",employee_name:"손흥민",department:"Quality",position:"Inspector",building:"C",line:"L1",hire_date:"2019-11-15",status:"ACTIVE",passCount:20,totalCount:20}];function pe(){z();const[x,F]=m.useState("all"),[H,$]=m.useState("6months"),[R,U]=m.useState("department"),S=m.useMemo(()=>ae.filter(s=>x==="all"||s.department===x),[x]),P=s=>{let n=[],c="";switch(s){case"department":n=S.map(a=>({부서:a.department,"직원 수":a.totalEmployees,"완료 교육":a.completedTrainings,미완료:a.pendingTrainings,"이수율(%)":a.completionRate,"평균 점수":a.averageScore,"합격률(%)":a.passRate})),c=`부서별_교육현황_${_(new Date,"yyyyMMdd")}.xlsx`;break;case"program":n=w.map(a=>({"프로그램 코드":a.program_code,프로그램명:a.program_name,"총 세션":a.totalSessions,"교육 인원":a.totalTrainees,합격:a.passCount,불합격:a.failCount,"합격률(%)":a.passRate,"평균 점수":a.averageScore,"재교육 필요":a.retrainingCount})),c=`프로그램별_현황_${_(new Date,"yyyyMMdd")}.xlsx`;break;case"employee":n=N.map(a=>({사번:a.employee_id,이름:a.employee_name,부서:a.department,직책:a.position,건물:a.building,라인:a.line,입사일:a.hire_date,상태:a.status,"교육 이수 건수":a.passCount,"총 교육 건수":a.totalCount})),c=`직원별_교육현황_${_(new Date,"yyyyMMdd")}.xlsx`;break}const p=v.json_to_sheet(n),j=v.book_new();v.book_append_sheet(j,p,"Report");const o=Object.keys(n[0]||{}).map(a=>({wch:Math.max(a.length,15)}));p["!cols"]=o,G(j,c)},h=m.useMemo(()=>{const s=N.length,n=N.reduce((o,a)=>o+a.totalCount,0),c=N.reduce((o,a)=>o+a.passCount,0),p=n>0?Math.round(c/n*100):0,j=w.length;return{totalEmployees:s,totalTrainings:n,passRate:p,activePrograms:j}},[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"리포트"}),e.jsx("p",{className:"text-muted-foreground",children:"교육 현황 분석 및 데이터 내보내기"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(k,{value:H,onValueChange:$,children:[e.jsxs(V,{className:"w-32",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),e.jsx(D,{})]}),e.jsxs(A,{children:[e.jsx(d,{value:"1month",children:"1개월"}),e.jsx(d,{value:"3months",children:"3개월"}),e.jsx(d,{value:"6months",children:"6개월"}),e.jsx(d,{value:"1year",children:"1년"})]})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsx(i,{children:e.jsx(r,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(L,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:h.totalEmployees}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"전체 직원"})]})]})})}),e.jsx(i,{children:e.jsx(r,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(B,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:h.totalTrainings}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"총 교육 건수"})]})]})})}),e.jsx(i,{children:e.jsx(r,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(K,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:[h.passRate,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"평균 합격률"})]})]})})}),e.jsx(i,{children:e.jsx(r,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(X,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:h.activePrograms}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"활성 프로그램"})]})]})})})]}),e.jsxs(W,{value:R,onValueChange:s=>U(s),children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[e.jsxs(q,{children:[e.jsxs(b,{value:"department",className:"gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"부서별"]}),e.jsxs(b,{value:"program",className:"gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"프로그램별"]}),e.jsxs(b,{value:"employee",className:"gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"직원별"]})]}),e.jsxs(E,{onClick:()=>P(R),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Excel 다운로드"]})]}),e.jsx(T,{value:"department",children:e.jsxs(i,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(f,{children:"부서별 교육 현황"}),e.jsx(y,{children:"부서별 교육 이수율 및 성과 분석"})]}),e.jsxs(k,{value:x,onValueChange:F,children:[e.jsxs(V,{className:"w-40",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),e.jsx(D,{placeholder:"부서 선택"})]}),e.jsxs(A,{children:[e.jsx(d,{value:"all",children:"전체 부서"}),se.map(s=>e.jsx(d,{value:s.value,children:s.label},s.value))]})]})]}),e.jsx(r,{children:e.jsxs(I,{children:[e.jsx(Q,{children:e.jsxs(g,{children:[e.jsx(t,{children:"부서"}),e.jsx(t,{className:"text-right",children:"직원 수"}),e.jsx(t,{className:"text-right",children:"완료 교육"}),e.jsx(t,{className:"text-right",children:"미완료"}),e.jsx(t,{className:"text-right",children:"이수율"}),e.jsx(t,{className:"text-right",children:"평균 점수"}),e.jsx(t,{className:"text-right",children:"합격률"})]})}),e.jsx(M,{children:S.map(s=>e.jsxs(g,{children:[e.jsx(l,{className:"font-medium",children:s.department}),e.jsx(l,{className:"text-right",children:s.totalEmployees}),e.jsx(l,{className:"text-right",children:s.completedTrainings}),e.jsx(l,{className:"text-right",children:s.pendingTrainings}),e.jsx(l,{className:"text-right",children:e.jsxs(u,{variant:s.completionRate>=80?"success":s.completionRate>=50?"warning":"destructive",children:[s.completionRate,"%"]})}),e.jsx(l,{className:"text-right",children:s.averageScore}),e.jsx(l,{className:"text-right",children:e.jsxs(u,{variant:s.passRate>=80?"success":s.passRate>=50?"warning":"destructive",children:[s.passRate,"%"]})})]},s.department))})]})})]})}),e.jsx(T,{value:"program",children:e.jsxs(i,{children:[e.jsxs(C,{children:[e.jsx(f,{children:"프로그램별 교육 현황"}),e.jsx(y,{children:"교육 프로그램별 참여율 및 합격률 분석"})]}),e.jsx(r,{children:e.jsxs(I,{children:[e.jsx(Q,{children:e.jsxs(g,{children:[e.jsx(t,{children:"프로그램 코드"}),e.jsx(t,{children:"프로그램명"}),e.jsx(t,{className:"text-right",children:"세션 수"}),e.jsx(t,{className:"text-right",children:"교육 인원"}),e.jsx(t,{className:"text-right",children:"합격"}),e.jsx(t,{className:"text-right",children:"불합격"}),e.jsx(t,{className:"text-right",children:"합격률"}),e.jsx(t,{className:"text-right",children:"평균 점수"})]})}),e.jsx(M,{children:w.map(s=>e.jsxs(g,{children:[e.jsx(l,{children:e.jsx(u,{variant:"outline",children:s.program_code})}),e.jsx(l,{className:"font-medium",children:s.program_name}),e.jsx(l,{className:"text-right",children:s.totalSessions}),e.jsx(l,{className:"text-right",children:s.totalTrainees}),e.jsx(l,{className:"text-right text-green-600",children:s.passCount}),e.jsx(l,{className:"text-right text-red-600",children:s.failCount}),e.jsx(l,{className:"text-right",children:e.jsxs(u,{variant:s.passRate>=80?"success":s.passRate>=50?"warning":"destructive",children:[s.passRate,"%"]})}),e.jsx(l,{className:"text-right",children:s.averageScore})]},s.program_code))})]})})]})}),e.jsx(T,{value:"employee",children:e.jsxs(i,{children:[e.jsxs(C,{children:[e.jsx(f,{children:"직원별 교육 현황"}),e.jsx(y,{children:"개인별 교육 이수 현황 (Excel 다운로드로 전체 데이터 확인)"})]}),e.jsx(r,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"직원별 상세 교육 현황은 Excel 파일로 다운로드하여 확인하세요."}),e.jsxs(E,{onClick:()=>P("employee"),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"직원별 현황 Excel 다운로드"]})]})})]})})]})]})}export{pe as default};

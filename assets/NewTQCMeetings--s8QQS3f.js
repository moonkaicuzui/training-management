import{j as e}from"./vendor-ui-3vVLwvSG.js";import{u as H,r as y}from"./vendor-react-3RSvEdhP.js";import{C as a,a as l,b as n,e as r,d as b}from"./index-DbE0N-7e.js";import{T as A,a as q,b as _,c as D}from"./tabs-BiL_WdmF.js";import{P as B}from"./LoadingSpinner-C546iy_4.js";import"./dialog-D5PoXStQ.js";import"./label-Dcyga6z7.js";import"./textarea-DKXFBtN7.js";import"./select-B9RdTlAY.js";import{a as E,M as K}from"./MeetingScheduleCard-CfxCra1l.js";import"./LazyCharts-DetV40kx.js";import{M as R}from"./NewTQCFilters-67u2fkdP.js";import{h as U,a as V,i as z,c as G,d as J}from"./newTqcStore-CYv8xO33.js";import"./switch-DEYTfbKs.js";import"./table-C47-Z7GG.js";import{w as k,s as f,$ as S,aj as X,g as Y}from"./vendor-icons-B-g4Br4W.js";import{r as Z,u as N,i as ee,j as se,k as te,f as m,m as ae}from"./vendor-utils-CC1vNFCq.js";import{k as g}from"./ko-Da8K_qaf.js";import"./vendor-i18n-BmxLmPQ7.js";import"./vendor-charts-B2i3rig-.js";import"./TraineeStatusBadge-27eUosfM.js";function ye(){const O=H(),j=U(),F=V(),t=z(),L=G(),{fetchMeetings:v,fetchTrainees:P,setMeetingFilters:w,updateMeeting:Q}=J();y.useEffect(()=>{(async()=>await Promise.all([v(t),P()]))()},[t]);const o=s=>F.find(h=>h.trainee_id===s)?.name||s,p=y.useMemo(()=>j.filter(s=>!(t.meetingType&&t.meetingType!=="all"&&s.meeting_type!==t.meetingType||t.status&&t.status!=="all"&&s.status!==t.status||t.dateFrom&&s.scheduled_date<t.dateFrom||t.dateTo&&s.scheduled_date>t.dateTo)),[j,t]),d=p.filter(s=>s.status==="SCHEDULED"),x=p.filter(s=>s.status==="COMPLETED"),I=p.filter(s=>s.status==="MISSED"),i=d.filter(s=>Z(new Date(s.scheduled_date))&&!N(new Date(s.scheduled_date))),u=ee(new Date,{weekStartsOn:1}),C=se(new Date,{weekStartsOn:1}),M=te({start:u,end:C}),W=s=>{w(s)},$=()=>{w({})},T=async s=>{await Q({meeting_id:s,status:"COMPLETED",completed_date:new Date().toISOString().split("T")[0]}),await v(t)};return L.meetings&&j.length===0?e.jsx(B,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"미팅 관리"}),e.jsx("p",{className:"text-muted-foreground",children:"신입 교육생 면담 일정 관리"})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(a,{children:[e.jsx(l,{className:"pb-2",children:e.jsxs(n,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4 text-primary"}),"예정된 미팅"]})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold",children:d.length})})]}),e.jsxs(a,{className:i.length>0?"border-destructive/50":"",children:[e.jsx(l,{className:"pb-2",children:e.jsxs(n,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 text-destructive"}),"지연된 미팅"]})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold text-destructive",children:i.length})})]}),e.jsxs(a,{children:[e.jsx(l,{className:"pb-2",children:e.jsxs(n,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4 text-status-pass"}),"완료된 미팅"]})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold text-status-pass",children:x.length})})]}),e.jsxs(a,{children:[e.jsx(l,{className:"pb-2",children:e.jsxs(n,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 text-orange-500"}),"미실시"]})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:I.length})})]})]}),e.jsx(a,{children:e.jsx(r,{className:"pt-6",children:e.jsx(R,{filters:t,onFiltersChange:W,onClear:$})})}),e.jsxs(A,{defaultValue:"list",children:[e.jsxs(q,{children:[e.jsxs(_,{value:"list",className:"gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"목록"]}),e.jsxs(_,{value:"calendar",className:"gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"캘린더"]})]}),e.jsxs(D,{value:"list",className:"space-y-6",children:[i.length>0&&e.jsxs(a,{className:"border-destructive/50",children:[e.jsxs(l,{children:[e.jsxs(n,{className:"text-lg text-destructive flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5"}),"지연된 미팅 (",i.length,")"]}),e.jsx(b,{children:"예정일이 지났으나 완료되지 않은 미팅입니다."})]}),e.jsx(r,{children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:i.map(s=>e.jsx(E,{meeting:s,traineeName:o(s.trainee_id),onComplete:T},s.meeting_id))})})]}),e.jsxs(a,{children:[e.jsx(l,{children:e.jsxs(n,{className:"text-lg flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"예정된 미팅 (",d.filter(s=>!i.includes(s)).length,")"]})}),e.jsx(r,{children:d.filter(s=>!i.includes(s)).length>0?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:d.filter(s=>!i.includes(s)).map(s=>e.jsx(E,{meeting:s,traineeName:o(s.trainee_id),onComplete:T},s.meeting_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"예정된 미팅이 없습니다."})})]}),e.jsxs(a,{children:[e.jsx(l,{children:e.jsxs(n,{className:"text-lg flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-status-pass"}),"완료된 미팅 (",x.length,")"]})}),e.jsx(r,{children:x.length>0?e.jsx("div",{className:"space-y-2",children:x.slice(0,10).map(s=>e.jsx(K,{meeting:s,traineeName:o(s.trainee_id)},s.meeting_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"완료된 미팅이 없습니다."})})]})]}),e.jsx(D,{value:"calendar",children:e.jsxs(a,{children:[e.jsxs(l,{children:[e.jsxs(n,{className:"text-lg",children:[m(u,"yyyy년 M월",{locale:g})," 주간 일정"]}),e.jsxs(b,{children:[m(u,"M월 d일",{locale:g})," - ",m(C,"M월 d일",{locale:g})]})]}),e.jsx(r,{children:e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[M.map(s=>e.jsxs("div",{className:`text-center p-2 font-medium ${N(s)?"bg-primary text-primary-foreground rounded-t-lg":""}`,children:[e.jsx("div",{className:"text-sm",children:m(s,"EEE",{locale:g})}),e.jsx("div",{className:"text-lg",children:m(s,"d")})]},s.toISOString())),M.map(s=>{const h=d.filter(c=>ae(new Date(c.scheduled_date),s));return e.jsx("div",{className:`min-h-[120px] p-2 border rounded-lg ${N(s)?"border-primary":""}`,children:h.length>0?e.jsx("div",{className:"space-y-1",children:h.map(c=>e.jsxs("div",{className:"p-2 bg-primary/10 rounded text-xs cursor-pointer hover:bg-primary/20 transition-colors",onClick:()=>O(`/new-tqc/trainees/${c.trainee_id}`),children:[e.jsx("div",{className:"font-medium truncate",children:o(c.trainee_id)}),e.jsx("div",{className:"text-muted-foreground",children:c.meeting_type==="1WEEK"?"1주":c.meeting_type==="1MONTH"?"1개월":"3개월"})]},c.meeting_id))}):e.jsx("div",{className:"text-center text-muted-foreground text-xs pt-4",children:"-"})},`content-${s.toISOString()}`)})]})})]})})]})]})}export{ye as default};
